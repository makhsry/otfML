clear;
clc;
load T300.mat
T300 = TABLE;
load T325.mat
T325 = TABLE;
load T350.mat
T350 = TABLE;
load T375.mat
T375 = TABLE;
load T400.mat
T400 = TABLE;
% CO : 1-6, 12, 13, 18
c01 = [...
    T300(:,5) T300(:,6) ...
    T325(:,5) T325(:,6) ...
    T350(:,5) T350(:,6) ...
    T375(:,5) T375(:,6) ...
    T400(:,5) T400(:,6)];  
c02 = [...
    T300(:,7) T300(:,8) ...
    T325(:,7) T325(:,8) ...
    T350(:,7) T350(:,8) ...
    T375(:,7) T375(:,8) ...
    T400(:,7) T400(:,8)];  
c03 = [...
    T300(:,9) T300(:,10) ...
    T325(:,9) T325(:,10) ...
    T350(:,9) T350(:,10) ...
    T375(:,9) T375(:,10) ...
    T400(:,9) T400(:,10)];  
c04 = [...
    T300(:,11) T300(:,12) ...
    T325(:,11) T325(:,12) ...
    T350(:,11) T350(:,12) ...
    T375(:,11) T375(:,12) ...
    T400(:,11) T400(:,12)];  
c05 = [...
    T300(:,13) T300(:,14) ...
    T325(:,13) T325(:,14) ...
    T350(:,13) T350(:,14) ...
    T375(:,13) T375(:,14) ...
    T400(:,13) T400(:,14)];  
c06 = [...
    T300(:,15) T300(:,16) ...
    T325(:,15) T325(:,16) ...
    T350(:,15) T350(:,16) ...
    T375(:,15) T375(:,16) ...
    T400(:,15) T400(:,16)];  
c12 = [...
    T300(:,27) T300(:,28) ...
    T325(:,27) T325(:,28) ...
    T350(:,27) T350(:,28) ...
    T375(:,27) T375(:,28) ...
    T400(:,27) T400(:,28)]; 
c13 = [...
    T300(:,29) T300(:,30) ...
    T325(:,29) T325(:,30) ...
    T350(:,29) T350(:,30) ...
    T375(:,29) T375(:,30) ...
    T400(:,29) T400(:,30)]; 
c18 = [...
    T300(:,39) T300(:,40) ...
    T325(:,39) T325(:,40) ...
    T350(:,39) T350(:,40) ...
    T375(:,39) T375(:,40) ...
    T400(:,39) T400(:,40)];    
% DI: 7, 8, 17
c07 = [...
    T300(:,17) T300(:,18) ...
    T325(:,17) T325(:,18) ...
    T350(:,17) T350(:,18) ...
    T375(:,17) T375(:,18) ...
    T400(:,17) T400(:,18)];  
c08 = [...
    T300(:,19) T300(:,20) ...
    T325(:,19) T325(:,20) ...
    T350(:,19) T350(:,20) ...
    T375(:,19) T375(:,20) ...
    T400(:,19) T400(:,20)];  
c17 = [...
    T300(:,37) T300(:,38) ...
    T325(:,37) T325(:,38) ...
    T350(:,37) T350(:,38) ...
    T375(:,37) T375(:,38) ...
    T400(:,37) T400(:,38)];   
% DN: 9-11, 14-16, 19-21
c09 = [...
    T300(:,21) T300(:,22) ...
    T325(:,21) T325(:,22) ...
    T350(:,21) T350(:,22) ...
    T375(:,21) T375(:,22) ...
    T400(:,21) T400(:,22)];  
c10 = [...
    T300(:,23) T300(:,24) ...
    T325(:,23) T325(:,24) ...
    T350(:,23) T350(:,24) ...
    T375(:,23) T375(:,24) ...
    T400(:,23) T400(:,24)];  
c11 = [...
    T300(:,25) T300(:,26) ...
    T325(:,25) T325(:,26) ...
    T350(:,25) T350(:,26) ...
    T375(:,25) T375(:,26) ...
    T400(:,25) T400(:,26)];  
c14 = [...
    T300(:,31) T300(:,32) ...
    T325(:,31) T325(:,32) ...
    T350(:,31) T350(:,32) ...
    T375(:,31) T375(:,32) ...
    T400(:,31) T400(:,32)];  
c15 = [...
    T300(:,33) T300(:,34) ...
    T325(:,33) T325(:,34) ...
    T350(:,33) T350(:,34) ...
    T375(:,33) T375(:,34) ...
    T400(:,33) T400(:,34)];  
c16 = [...
    T300(:,35) T300(:,36) ...
    T325(:,35) T325(:,36) ...
    T350(:,35) T350(:,36) ...
    T375(:,35) T375(:,36) ...
    T400(:,35) T400(:,36)];  
c19 = [...
    T300(:,41) T300(:,42) ...
    T325(:,41) T325(:,42) ...
    T350(:,41) T350(:,42) ...
    T375(:,41) T375(:,42) ...
    T400(:,41) T400(:,42)];  
c20 = [...
    T300(:,43) T300(:,44) ...
    T325(:,43) T325(:,44) ...
    T350(:,43) T350(:,44) ...
    T375(:,43) T375(:,44) ...
    T400(:,43) T400(:,44)];  
c21 = [...
    T300(:,45) T300(:,46) ...
    T325(:,45) T325(:,46) ...
    T350(:,45) T350(:,46) ...
    T375(:,45) T375(:,46) ...
    T400(:,45) T400(:,46)];  
% IBF
cIBF = [...
    T300(:,1) T300(:,2) ...
    T325(:,1) T325(:,2) ...
    T350(:,1) T350(:,2) ...
    T375(:,1) T375(:,2) ...
    T400(:,1) T400(:,2)]; 
% NCTA 
cNCTA = [...
    T300(:,3) T300(:,4) ...
    T325(:,3) T325(:,4) ...
    T350(:,3) T350(:,4) ...
    T375(:,3) T375(:,4) ...
    T400(:,3) T400(:,4)];  
%Porosity
cV = [...
    T300(:,47) T300(:,48) ...
    T325(:,47) T325(:,48) ...
    T350(:,47) T350(:,48) ...
    T375(:,47) T375(:,48) ...
    T400(:,47) T400(:,48)];
clear TABLE T300 T325 T325 T350 T375 T400
% Pairs 
cPairs = c01 + c02 + c03 + c04 + c05 + c06 + c07 + c08 + ...
    c09 + c10 + c11 + c12 + c13 + c14 + c15 + c16 + c17 + ...
    c18 + c19 + c20 + c21;
cPairs(:, 1:2:9) = cPairs(:, 1:2:9)/21;
% CO : 1-6, 12, 13, 18 
cCO = c01 + c02 + c03 + c04 + c05 + c06 + c12 + c13 + c18;
cCO(:, 1:2:9) = cCO(:, 1:2:9)/9;
% DN: 9-11, 14-16, 19-21
cDN = c09 + c10 + c11 + c14 + c15 + c16 + c19 + c20 + c21;
cDN(:, 1:2:9) = cDN(:, 1:2:9)/9;
% DI: 7, 8, 17
cDI = c07 + c08 + c17;
cDI(:, 1:2:9) = cDI(:, 1:2:9)/3;
% Total 
cTOT = c01 + c02 + c03 + c04 + c05 + c06 + c07 + c08 + ...
    c09 + c10 + c11 + c12 + c13 + c14 + c15 + c16 + c17 + ...
    c18 + c19 + c20 + c21 + cIBF + cNCTA; 
cTOT(:, 1:2:9) = cTOT(:, 1:2:9)/23;
% - Normalization 
List = who('c*');
for i = 1:length(List)
    myMAT = evalin('base', List{i});
    for j = 2:2:10
        MIN = min(min(myMAT(:,j)));
        MAX = max(max(myMAT(:,j))); 
        if MAX == MIN
            flag = 'broken'; 
            break;
        else 
            flag = 'safe';
            myMAT(:,j) = (myMAT(:,j) - MIN) / (MAX - MIN);
        end
    end
    Normalized.IDs{i,1} = List{i}; 
    Normalized.Flags{i,1} = flag; 
    Normalized.Values{i,1} = myMAT;
%     figure;
%     hold on; 
%     for k = 1:2:9
%         plot(myMAT(:,k), myMAT(:,k+1));
%         legend(List{i});
%     end
%     hold off;
%     axis([0 length(myMAT(:,1)) 0 1]);
%     text(50000,0.5,Normalized.Flags{i});
%     legend('T = 300K', 'T = 325K', 'T = 350K', 'T = 375K', 'T = 400K');
%     saveas(gcf,[List{i} +'_Norm.png']);
end
close all
clear i j k MAX MIN myMAT flag 
% fraction 
ico = 0;
idn = 0; 
idi = 0;
for i = 1:21
    myMAT = evalin('base', List{i});
    myMAT (1,:) = [];
    ft.IDs{i,1} = List{i}; 
    fp.IDs{i,1} = List{i}; 
    MAT = myMAT;
    MAT(:, 2:2:10) = MAT(:, 2:2:10) ./ cTOT (2:end,2:2:10);
    ft.Values{i,1} = MAT;
    MAT = myMAT;
    MAT(:, 2:2:10) = MAT(:, 2:2:10) ./ cPairs (2:end,2:2:10);
    fp.Values{i,1} = MAT;
    % 
    if any([1 2 3 4 5 6 12 13 18] == i)
        ico = ico + 1; 
        % CO : 1-6, 12, 13, 18 
        fco.IDs{ico,1} = List{i};
        MAT = myMAT;
        MAT(:, 2:2:10) = MAT(:, 2:2:10) ./ cCO (2:end,2:2:10);
        fco.Values{ico,1} = MAT;
    end
    if any([9 10 11 14 15 16 19 20 21] == i)
        idn = idn + 1;
        % DN: 9-11, 14-16, 19-21
        fdn.IDs{idn,1} = List{i};
        MAT = myMAT;
        MAT(:, 2:2:10) = MAT(:, 2:2:10) ./ cDN (2:end,2:2:10);
        fdn.Values{idn,1} = MAT;
    end
    if any([7 8 17] == i)
        % DI: 7, 8, 17
        idi = idi + 1;
        fdi.IDs{idi,1} = List{i};
        MAT = myMAT;
        MAT(:, 2:2:10) = MAT(:, 2:2:10) ./ cDI (2:end,2:2:10);
        fdi.Values{idi,1} = MAT;
    end
end
% % 
% for idi = 1:length(fdi.Values)
%     figure;
%     hold on; 
%      for k = 1:2:9
%          plot(fdi.Values{idi,1}(:,k), fdi.Values{idi,1}(:,k+1));
%      end
%      hold off;
% end 
% for idn = 1:length(fdn.Values) 
%     figure;
%     hold on; 
%      for k = 1:2:9
%          plot(fdn.Values{idn,1}(:,k), fdn.Values{idn,1}(:,k+1));
%      end
%      hold off;
% end   
% for ico = 1:length(fco.Values) 
%     figure;
%     hold on; 
%      for k = 1:2:9
%          plot(fco.Values{ico,1}(:,k), fco.Values{ico,1}(:,k+1));
%      end
%      hold off;
% end
% % 
% for j = 1:length(fp.Values) 
%     figure;
%     hold on; 
%      for k = 1:2:9
%          plot(fp.Values{j,1}(:,k), fp.Values{j,1}(:,k+1));
%      end
%      hold off;
% end
% for j = 1:length(ft.Values) 
%     figure;
%     hold on; 
%      for k = 1:2:9
%          plot(ft.Values{j,1}(:,k), ft.Values{j,1}(:,k+1));
%      end
%      hold off;
% end
% plot(ft.Values{j,1}(end,1), ft.Values{j,1}(end,2),'-o');
% hold on
% plot(ft.Values{j,1}(end,3), ft.Values{j,1}(end,4),'-s');
% plot(ft.Values{j,1}(end,5), ft.Values{j,1}(end,6),'-^');
% plot(ft.Values{j,1}(end,7), ft.Values{j,1}(end,8),'-v');
% plot(ft.Values{j,1}(end,9), ft.Values{j,1}(end,10),'-.');
% legend('T = 300K', 'T = 325K', 'T = 350K', 'T = 375K', 'T = 400K');
for ico = 1:length(ft.Values) 
    ft.Values{ico,1}(:,1:2:9) = [];
end
for ico = 1:length(ft.Values) 
    ft.Values{ico,1}(1,:) = [];
end
for i = 1:length(ft.Values) 
    figure
    contourf(ft.Values{i,1});
    xlabel('Temperature (K)','FontSize',12,'FontWeight','bold');
    ylabel('time','FontSize',12,'FontWeight','bold');
    xticklabels({'300','','325','','350','','375','','400'})
    colorbar
    %plotmatrix(ft.Values{ico,1});
end



